# COMP0241 项目拍摄要求总结

根据项目文档，以下是各题需要拍摄的素材和拍摄方法：

## 设备说明
- **两个相机**：Arducam 全局快门 RGB 相机（或单色相机）
- **固定相机的长杆**：用于固定相机位置，确保静态拍摄

---

## 各题拍摄要求

### **任务1：提取天文对象（AO）从图像中（30%）**

#### 需要拍摄的素材：
1. **静态图像**：
   - 至少拍摄几张不同光照条件下的 AO 图像
   - 用于演示分割方法的效果
   - 需要与测试集中的 `Easy/000016.png` 进行对比

#### 拍摄方法：
- 使用**一个相机**即可
- 可以从不同角度拍摄（正面、侧面等）
- **注意**：
  - 确保光照条件一致且充足
  - 选择合适角度以有效捕捉 AO
  - 可以拍摄多张不同条件的图像用于测试

---

### **任务2：测量旋转轴的投影点和AO的高度（25%）**

#### 需要拍摄的素材：
1. **视频序列**（用于任务2b）：
   - 使用**静态相机**拍摄 AO 随时间移动的视频
   - 用于分析 AO 中心是否因摆动而移动
   - 需要绘制中心点轨迹随时间的变化

2. **图像/视频**（用于任务2c）：
   - 用于估计 AO 距离地面的高度
   - 需要能够看到 AO 的最低点和地面平面

#### 拍摄方法：
- **任务2b**：
  - 使用**固定相机的长杆**固定一个相机
  - 相机位置保持**静态不动**
  - 拍摄一段视频，记录 AO 的摆动运动
  - 视频需要足够长以观察中心点的移动轨迹

- **任务2c**：
  - 可以从侧面或斜上方角度拍摄
  - 确保能清晰看到 AO 的底部和地面
  - 可能需要使用辅助传感器（如 LiDAR）进行验证

---

### **任务3：估计AO的旋转周期（35%）**

#### 需要拍摄的素材：
1. **视频**（用于任务3b, 3c, 3d, 3e）：
   - 用于手动和自动估计旋转周期
   - 需要足够长的视频以观察至少一个完整旋转周期

2. **同步双视角视频**（用于任务3f）：
   - **两个相机同时拍摄**
   - 从**两个不同视角**：
     - **视角1**：从地面向上看的底部视角（bottom view）
     - **视角2**：侧面视角（side view）
   - 两个视频需要**同步**，确保时间对应

#### 拍摄方法：
- **任务3b, 3c, 3d, 3e**：
  - 使用**一个相机**即可
  - 可以手持或固定拍摄
  - 拍摄一段足够长的视频（建议至少包含2-3个完整旋转周期）

- **任务3f（重要）**：
  - 使用**两个相机**同时拍摄
  - **相机1**：放置在地面，向上拍摄 AO（底部视角）
     - 可以使用固定长杆固定在地面附近
  - **相机2**：放置在侧面，拍摄 AO 的侧面视角
     - 可以使用固定长杆固定在合适高度
  - **同步要求**：
     - 两个相机必须**同时开始录制**
     - 建议使用相同的时间戳或同步信号
     - 确保两个视频的时间对应关系准确
  - **拍摄时长**：需要足够长以进行旋转周期比较

---

### **任务4：估计无人机的着陆速度（10%）**

#### 需要拍摄的素材：
1. **图像/视频**：
   - 用于测量 AO 的直径
   - 需要从不同角度观察 AO 的尺寸
   - 用于计算表面线性速度

#### 拍摄方法：
- 使用**一个或两个相机**
- 可以从多个角度拍摄以评估半径的一致性
- 需要能够看到 AO 的完整轮廓

---

## 通用拍摄建议

### 1. **光照条件**
- 确保光照**一致且充足**
- 避免强烈阴影和反光
- 建议在相同光照条件下拍摄所有素材

### 2. **相机角度**
- 选择**合适的角度**以有效捕捉 AO
- 确保 AO 在画面中清晰可见
- 避免遮挡

### 3. **同步（多相机时）**
- 如果使用多个相机，必须**正确同步**
- 确保时间对应关系准确
- 可以使用：
  - 同时按下录制按钮
  - 使用同步信号
  - 记录开始时间戳

### 4. **固定长杆的使用**
- **任务2b**：必须使用固定长杆确保相机静态
- **任务3f**：可以使用固定长杆固定两个相机在不同位置
- 确保长杆稳定，避免振动

---

## 设备配置建议

### 场景1：任务2b（静态相机）
```
[固定长杆] → [相机] → 拍摄 AO 摆动视频
（相机位置固定不动）
```

### 场景2：任务3f（双视角同步）
```
相机1（底部视角）         相机2（侧面视角）
[固定长杆]                [固定长杆]
    ↓                          ↓
[地面向上]              [侧面拍摄]
    ↓                          ↓
    同时拍摄 AO 旋转视频
```

---

---

## 各题实施方法论

### **任务1：提取AO对象的方法论**

#### 1a. 实现至少两种提取方法（10%）

**方法论**：
1. **颜色阈值法（Colour Thresholding）**：
   - 分析 AO 的颜色特征（RGB/HSV 空间）
   - 设置阈值范围提取 AO 区域
   - 适用于 AO 与背景颜色差异明显的场景

2. **几何特征法（Geometry-based）**：
   - **边缘检测**：使用 Canny、Sobel 等算子检测边缘
   - **直线提取**：使用 Hough 变换提取 AO 的轮廓线
   - **形态学操作**：使用开运算、闭运算等处理分割结果

**拍摄要求**：
- 拍摄至少一张自己的图像用于演示
- 与测试集 `Easy/000016.png` 进行对比
- 记录不同光照条件下的效果

#### 1b. 组合方法提高准确性（5%）

**方法论**：
- 将 1a 中的两种方法结合：
  - 颜色阈值 + 边缘检测
  - 使用逻辑运算（AND/OR）组合结果
  - 形态学后处理优化最终掩码

**拍摄要求**：
- 使用与 1a 相同的图像
- 对比组合前后的效果

#### 1c. ROC 曲线评估（5%）

**方法论**：
- 使用测试集的真实掩码（ground-truth）
- 对每个方法绘制 ROC 曲线
- 固定其他参数，只变化一个关键参数
- 解释参数选择的原因（控制假阳性/假阴性）

**不需要额外拍摄**：使用测试集数据

#### 1d. 参数优化（10%）

**方法论**：
- 对组合方法进行参数搜索
- 生成 3D 表面图或 2D 热力图
- 选择评估指标（Youden's J、AUC 等）
- 找到最佳参数对
- 对比定量优化结果与定性选择

**拍摄要求**：
- 使用一张自己拍摄的图像
- 使用一张测试集中的图像
- 对比不同参数下的效果差异

---

### **任务2：测量中心点和高度的方法论**

#### 2a. 确定几何中心（5%）

**方法论**：
- 使用图像处理技术计算 AO 的质心（centroid）
- 方法：
  - 从二值掩码计算质心坐标
  - 使用矩（moments）计算中心点
  - 公式：`cx = M10/M00, cy = M01/M00`

**拍摄要求**：
- 静态图像即可
- 确保 AO 完整可见

#### 2b. 评估中心点移动（10%）

**方法论**：
1. **使用静态相机**：
   - 相机位置必须固定（使用固定长杆）
   - 确保相机在整个拍摄过程中不动

2. **视频处理流程**：
   - 对每一帧提取 AO 的中心点
   - 记录中心点坐标随时间的变化
   - 绘制中心点轨迹图（x-t, y-t 图）
   - 量化摆动幅度和频率

3. **分析指标**：
   - 中心点移动的最大距离
   - 移动的标准差
   - 摆动周期（如果有）

**拍摄方法**：
- **必须使用固定长杆**固定相机
- 相机位置保持静态不动
- 拍摄足够长的视频（建议至少 30 秒，包含多个摆动周期）
- 确保帧率足够（30fps 或更高）
- 视频中 AO 应始终在画面内

**实施步骤**：
1. 将相机固定在长杆上
2. 调整相机角度，确保 AO 在画面中心
3. 开始录制，保持相机完全静止
4. 录制足够长的视频以观察摆动
5. 停止录制，检查视频质量

#### 2c. 估计 AO 高度（10%）

**方法论**：
1. **相机标定**：
   - 进行相机内参标定（如创新实验室活动中的方法）
   - 获取焦距、主点等参数

2. **高度估计方法**：
   - **方法1：几何测量法**：
     - 使用已知参考物体（如地面标记、已知尺寸物体）
     - 通过相似三角形计算高度
   - **方法2：深度估计法**：
     - 使用立体相机或 TOF 相机
     - 直接测量深度信息
   - **方法3：单目深度估计**：
     - 使用深度学习模型估计深度
     - 结合相机参数计算实际高度

3. **验证**：
   - 使用辅助传感器（LiDAR、TOF 相机）验证
   - 对比不同方法的结果

**拍摄方法**：
- 从侧面或斜上方角度拍摄
- 确保能同时看到：
  - AO 的最低点
  - 地面平面
  - 参考物体（如果有）
- 可以拍摄多张不同角度的图像
- 如果使用辅助传感器，需要同步采集数据

**实施步骤**：
1. 设置参考物体（已知尺寸）
2. 调整相机角度，确保 AO 底部和地面可见
3. 拍摄图像/视频
4. 使用辅助传感器（如 LiDAR）进行验证测量
5. 记录所有测量数据

---

### **任务3：估计旋转周期的方法论**

#### 3a. 解释方法论（5%）

**方法论选择**：
- **方法1：特征点跟踪**：
  - 检测 AO 表面的特征点
  - 跟踪特征点的旋转轨迹
  - 计算回到原位置的时间
- **方法2：模板匹配**：
  - 选择 AO 的初始状态作为模板
  - 在后续帧中搜索匹配
  - 找到完全匹配的帧，计算时间差
- **方法3：频域分析**：
  - 对视频序列进行 FFT
  - 分析主要频率成分
  - 计算旋转周期
- **方法4：光流法**：
  - 计算相邻帧之间的光流
  - 分析旋转方向和速度
  - 积分得到旋转周期

**不需要额外拍摄**：使用已有视频

#### 3b. 单次旋转周期估计（5%）

**方法论**：
- 手动检查视频
- 标记 AO 回到原始位置的时间戳
- 计算时间差

**拍摄要求**：
- 一个视频，包含至少 1-2 个完整旋转周期
- 帧率足够高（30fps 或更高）
- 视频清晰，AO 特征可见

#### 3c. 自动旋转周期估计（5%）

**方法论**：
- 实现自动算法检测旋转周期
- 不需要实时处理（可以使用完整视频）
- 与 3b 的手动结果对比

**拍摄要求**：
- 使用与 3b 相同的视频
- 或拍摄新的视频用于自动估计

#### 3d. 快速旋转周期估计（5%）

**方法论**：
- 处理速度必须快于视频播放速度
- 每帧处理时间 < 1/帧率（如 30fps 需要 < 0.033s）
- 禁用可视化以提高速度
- 在终端显示处理时间：
  ```
  FPS: 30 / Processing time: 0.025s
  ```

**拍摄要求**：
- 使用预录制的视频
- 确保视频帧率已知
- 可以复用 3b/3c 的视频

#### 3e. 实时角速度估计（10%）

**方法论**：
- 实时处理，只能使用当前帧（无未来帧）
- 每帧处理时间 < 1/帧率
- 每帧输出角速度（秒/转）
- 可以使用 3d 的方法，但需要实时输入

**拍摄要求**：
- 实时视频流或预录制视频（模拟实时）
- 确保帧率稳定
- 可以复用之前的视频

#### 3f. 不同视角对比（5%）

**方法论**：
1. **双相机同步**：
   - 两个相机同时开始录制
   - 使用时间戳或同步信号
   - 确保时间对应关系准确

2. **视角选择**：
   - **底部视角**：从地面向上看
     - 优点：可以看到 AO 底部的旋转特征
     - 缺点：可能受光照影响
   - **侧面视角**：从侧面观察
     - 优点：可以看到 AO 的完整轮廓
     - 缺点：可能受摆动影响

3. **同步方法**：
   - **方法1**：同时按下录制按钮，记录开始时间
   - **方法2**：使用外部同步信号
   - **方法3**：使用时间戳对齐
   - **方法4**：使用视频中的共同事件对齐（如 AO 到达特定位置）

4. **对比分析**：
   - 分别计算两个视角的旋转周期
   - 对比结果差异
   - 分析差异原因（视角、光照、遮挡等）

**拍摄方法（关键）**：
1. **设备准备**：
   - 两个 Arducam 相机
   - 两个固定长杆
   - 确保两个相机设置相同（分辨率、帧率）

2. **相机1（底部视角）设置**：
   - 将相机固定在长杆上
   - 放置在地面附近，镜头向上
   - 调整角度，确保 AO 在画面中心
   - 固定长杆，确保稳定

3. **相机2（侧面视角）设置**：
   - 将相机固定在另一个长杆上
   - 放置在 AO 的侧面，合适的高度
   - 调整角度，确保 AO 完整可见
   - 固定长杆，确保稳定

4. **同步拍摄**：
   - 两人同时操作，或使用同步信号
   - 同时开始录制
   - 记录开始时间戳
   - 拍摄足够长的视频（建议至少包含 3-5 个完整旋转周期）

5. **拍摄后检查**：
   - 检查两个视频的时长是否一致
   - 检查两个视频的帧率是否相同
   - 验证同步准确性（可以对比视频中的共同事件）

**实施步骤**：
```
步骤1：设置相机1（底部视角）
  - 固定长杆在地面
  - 安装相机，镜头向上
  - 调整角度和焦距
  - 锁定位置

步骤2：设置相机2（侧面视角）
  - 固定长杆在侧面合适位置
  - 安装相机，镜头朝向 AO
  - 调整角度和焦距
  - 锁定位置

步骤3：同步准备
  - 检查两个相机设置（分辨率、帧率）
  - 准备同步信号或约定开始时间
  - 确保两个相机都准备好

步骤4：同步拍摄
  - 倒计时：3, 2, 1, 开始
  - 同时按下两个相机的录制按钮
  - 记录开始时间戳
  - 保持拍摄至少 30-60 秒

步骤5：停止拍摄
  - 同时停止两个相机
  - 记录结束时间戳
  - 检查视频文件
```

---

### **任务4：估计着陆速度的方法论**

#### 4a. 估计 AO 直径（5%）

**方法论**：
1. **相机标定**：
   - 进行相机标定，获取内参
   - 如果可能，进行外参标定（相机到 AO 的距离）

2. **直径测量方法**：
   - **方法1：已知参考物体**：
     - 在场景中放置已知尺寸的参考物体
     - 通过像素比例计算 AO 直径
   - **方法2：深度传感器**：
     - 使用 LiDAR 或 TOF 相机测量距离
     - 结合像素尺寸计算实际直径
   - **方法3：立体视觉**：
     - 使用立体相机（如 Intel D455）
     - 通过视差计算深度和尺寸

3. **半径一致性评估**：
   - 从不同方向测量半径（x、y 方向）
   - 可视化结果（如任务描述中的图6）
   - 分析半径是否均匀

**拍摄方法**：
- 从多个角度拍摄 AO
- 确保能看到 AO 的完整轮廓
- 如果使用参考物体，确保参考物体和 AO 在同一画面中
- 可以拍摄多张不同角度的图像

#### 4b. 计算表面线性速度（5%）

**方法论**：
1. **建立坐标系**：
   - 定义 AO 的经纬度网格
   - 建立地球坐标系

2. **速度计算**：
   - 对于每个纬度，计算该点的线速度
   - 公式：`v = ω × r × cos(latitude)`
   - 其中 ω 是角速度（从任务3获得），r 是半径

3. **可视化**：
   - 创建速度分布图（如任务描述中的图7）
   - 显示不同纬度的速度差异

**拍摄要求**：
- 使用任务3的视频
- 可能需要额外的图像用于建立坐标系
- 确保能识别 AO 表面的特征点

---

## 通用实施方法论

### 1. 相机标定方法

**为什么需要标定**：
- 任务2c 和任务4 需要实际测量
- 需要将像素坐标转换为实际尺寸

**标定方法**（参考创新实验室活动）：
1. **棋盘格标定**：
   - 使用棋盘格图案
   - 拍摄多张不同角度的图像
   - 使用 OpenCV 的 `calibrateCamera` 函数
   - 获取内参矩阵和畸变系数

2. **标定步骤**：
   - 准备棋盘格（打印或使用平板显示）
   - 从不同角度拍摄至少 10-20 张图像
   - 确保棋盘格在画面中清晰可见
   - 使用标定工具处理图像

### 2. 视频同步方法

**方法1：时间戳同步**
- 记录两个视频的开始时间戳
- 计算时间差，对齐帧序列
- 适用于精确时间戳的情况

**方法2：事件同步**
- 在视频开始时制造共同事件（如拍手、闪光）
- 在视频中检测该事件
- 对齐事件发生的时间点

**方法3：特征同步**
- 检测 AO 到达特定位置的时间
- 在两个视频中找到相同的特征点位置
- 对齐这些时间点

**方法4：硬件同步**
- 使用外部同步信号
- 两个相机连接到同一触发源
- 确保帧级同步

### 3. 实时处理优化方法

**优化策略**：
1. **算法优化**：
   - 使用高效的算法（如快速傅里叶变换）
   - 减少不必要的计算
   - 使用多线程处理

2. **代码优化**：
   - 禁用可视化
   - 减少内存分配
   - 使用 NumPy 向量化操作
   - 避免 Python 循环，使用 C/C++ 扩展

3. **分辨率优化**：
   - 降低处理分辨率（保持输入分辨率）
   - 使用 ROI（感兴趣区域）处理

4. **预处理优化**：
   - 预处理时间计入总处理时间
   - 优化预处理步骤
   - 考虑使用 GPU 加速

### 4. 数据收集计划

**建议的数据收集顺序**：
1. **第一阶段**：任务1 的图像
   - 拍摄不同光照条件的图像
   - 用于方法开发和测试

2. **第二阶段**：任务2 的视频
   - 使用固定长杆拍摄静态视频
   - 用于中心点移动分析

3. **第三阶段**：任务3 的视频
   - 拍摄旋转视频（单相机）
   - 用于旋转周期估计

4. **第四阶段**：任务3f 的双视角视频
   - 同步拍摄两个视角
   - 用于视角对比

5. **第五阶段**：任务4 的测量数据
   - 拍摄用于直径测量的图像
   - 如有需要，使用辅助传感器

---

## 注意事项

1. **数据收集截止时间**：2025年12月11日 17:00 前完成所有数据采集
2. **视频质量**：确保视频清晰，帧率足够（建议30fps或更高）
3. **存储**：确保有足够的存储空间保存所有视频和图像
4. **备份**：建议对重要素材进行备份
5. **相机标定**：如果需要实际测量，必须进行相机标定
6. **参数选择**：不同任务可以使用不同的参数，不需要保持一致
7. **实时处理**：只有任务3e 明确要求实时处理，其他任务可以使用完整视频
8. **报告要求**：12页限制，合理规划空间，先完成基础任务再处理困难任务

